import{r as s,j as e,B as x,C as b,c as N}from"./index-B6T-XhSG.js";import{Q as c}from"./react-toastify.esm-CR3KtYOa.js";import{C as y}from"./clipboard-copy-CGttmhrS.js";const S=()=>{const[r,m]=s.useState(""),[i,p]=s.useState([]),[n,d]=s.useState(!1),[v,l]=s.useState(!1),h="0x8576E2D1bF399Ae7E41167458a3866E9efD1Ce4A",g=async()=>{if(!window.ethereum)return c.error("Please install MetaMask.");const o=await new x(window.ethereum).send("eth_requestAccounts",[]);m(o[0]),c.success("Wallet connected successfully!")},u=async()=>{try{d(!0);const o=await new x(window.ethereum).getSigner(),j=(await new b(h,N,o).getAllRecords()).map((a,w)=>({id:w+1,patient:a.patient,diagnosis:a.diagnosis,prescription:a.prescription,date:new Date(Number(a.timestamp)*1e3).toLocaleString()}));p(j)}catch(t){console.error("Error fetching records:",t),c.error("Failed to fetch patient records.")}finally{d(!1)}},f=()=>{navigator.clipboard.writeText(r),l(!0),c.success("Wallet address copied!"),setTimeout(()=>l(!1),2e3)};return s.useEffect(()=>{g()},[]),e.jsxs("div",{className:"p-6 min-h-screen bg-gradient-to-b from-blue-50 to-white",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-blue-700",children:"👨‍⚕️ Doctor Dashboard"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-sm text-gray-600 truncate max-w-[180px]",children:r||"Not Connected"}),e.jsx(Button,{onClick:f,variant:"outline",size:"icon",children:e.jsx(y,{size:16})})]})]}),e.jsx("div",{className:"flex gap-4 mb-6",children:e.jsx(Button,{onClick:u,disabled:n,children:n?"Loading Records...":"View Patient Records"})}),e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:i.map(t=>e.jsxs("div",{className:"bg-white rounded-xl shadow p-4",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-800",children:["Patient: ",t.patient.slice(0,6),"...",t.patient.slice(-4)]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[e.jsx("strong",{children:"Diagnosis:"})," ",t.diagnosis]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[e.jsx("strong",{children:"Prescription:"})," ",t.prescription]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:[e.jsx("strong",{children:"Date:"})," ",t.date]})]},t.id))}),!i.length&&!n&&e.jsx("p",{className:"text-center text-gray-500 mt-10",children:"No medical records available yet."})]})};export{S as default};
