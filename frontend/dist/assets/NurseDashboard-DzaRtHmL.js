import{a,u as v,j as e,f as w,B as y,C,c as S}from"./index-nTQIyIYe.js";import{B as p,C as A}from"./button-C8d14KLS.js";import{Q as u}from"./react-toastify.esm-UE-0H8Ct.js";import{h as D}from"./hospitalApi-BvT66DJ5.js";function E({patientId:r}){const[g,d]=a.useState(""),[n,o]=a.useState(""),[i,f]=a.useState(""),[c,m]=a.useState(""),{addToast:x}=v(),h=async s=>{s.preventDefault();try{const t=await D.postEHR(r||"unknown",{type:"vitals",bp:g,hr:n,temp:i,notes:c,timestamp:new Date().toISOString()});x("Vitals saved to hospital EHR","success")}catch(t){console.error(t),x("Failed to save vitals: "+(t.message||t),"error")}};return e.jsxs("form",{onSubmit:h,className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx("input",{placeholder:"Blood Pressure (e.g. 120/80)",value:g,onChange:s=>d(s.target.value),className:"border p-2"}),e.jsx("input",{placeholder:"Heart Rate (bpm)",value:n,onChange:s=>o(s.target.value),className:"border p-2"}),e.jsx("input",{placeholder:"Temperature (Â°C)",value:i,onChange:s=>f(s.target.value),className:"border p-2"})]}),e.jsx("textarea",{placeholder:"Notes",value:c,onChange:s=>m(s.target.value),className:"w-full border p-2"}),e.jsx("button",{className:"px-4 py-2 bg-indigo-600 text-white rounded",children:"Save Vitals"})]})}const V=()=>{const[r,g]=a.useState(""),[d,n]=a.useState([]),[o,i]=a.useState(!1),[f,c]=a.useState(!1),m="0xaCA3eF3906639995Fb31Bd58dbcDD0d3CFa2abE8",x=async()=>{try{if(i(!0),!window.ethereum){u.error("No Ethereum provider found. Please connect your wallet.");return}const j=await new y(window.ethereum).getSigner(),b=(await new C(m,S,j).getAllPatients()).map((l,N)=>({id:N+1,name:l.name,age:Number(l.age),gender:l.gender,diagnosis:l.diagnosis,date:new Date(Number(l.timestamp)*1e3).toLocaleString()}));n(b)}catch(t){console.error("Error fetching patient data:",t),u.error("Failed to fetch patient records.")}finally{i(!1)}},h=async()=>{try{const t=await w.get("/api/hospital/patients");n(Array.isArray(t.data)?t.data:[])}catch(t){console.warn("Failed to load backend patients",t.message||t)}},s=()=>{navigator.clipboard.writeText(r),c(!0),u.success("Wallet address copied!"),setTimeout(()=>c(!1),2e3)};return a.useEffect(()=>{},[]),a.useEffect(()=>{h()},[]),e.jsxs("div",{className:"p-6 min-h-screen bg-white",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-pink-700",children:"ðŸ©º Nurse Dashboard"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-sm text-gray-600 truncate max-w-[180px]",children:r||"Not Connected"}),e.jsx(p,{onClick:s,variant:"outline",size:"icon",children:e.jsx(A,{size:16})})]})]}),e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsx(p,{onClick:x,disabled:o,children:o?"Loading...":"View Patient Records"}),e.jsx(p,{onClick:h,variant:"outline",children:"Refresh (Backend)"})]}),e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:d.map(t=>e.jsxs("div",{className:"bg-white rounded-xl shadow p-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:t.name}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[e.jsx("strong",{children:"Age:"})," ",t.age]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"Gender:"})," ",t.gender]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[e.jsx("strong",{children:"Diagnosis:"})," ",t.diagnosis]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:[e.jsx("strong",{children:"Date:"})," ",t.date]})]},t.id))}),e.jsxs("div",{className:"mt-6 p-4 bg-white rounded-xl shadow border border-slate-100",children:[e.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Enter Vitals"}),e.jsx(E,{})]}),!d.length&&!o&&e.jsx("p",{className:"text-center text-gray-500 mt-10",children:"No patient data available yet."})]})};export{V as default};
