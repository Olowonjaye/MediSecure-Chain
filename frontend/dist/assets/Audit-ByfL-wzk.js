import{a as b,b as g,r as a,j as e,B as f,C as j,c as y}from"./index-9F5p74Tb.js";import{Q as o}from"./react-toastify.esm-D6P_Q-G5.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],w=b("copy",N),B=()=>{const{user:d}=g(),[c,n]=a.useState([]),[x,h]=a.useState(!0),l="0x8576E2D1bF399Ae7E41167458a3866E9efD1Ce4A";a.useEffect(()=>{(async()=>{try{if(!window.ethereum){o.error("MetaMask not detected!");return}const s=new f(window.ethereum),v=await s.getSigner(),i=new j(l,y,s),p=i.filters.RecordUpdated(),u=(await i.queryFilter(p,0,"latest")).map(r=>({id:r.transactionHash,recordId:r.args.recordId.toString(),updatedBy:r.args.updatedBy,timestamp:new Date(Number(r.args.timestamp)*1e3).toLocaleString(),txHash:r.transactionHash}));n(u.reverse())}catch(s){console.error("Error fetching audit logs:",s),o.error("Failed to load audit logs")}finally{h(!1)}})()},[l]);const m=t=>{navigator.clipboard.writeText(t),o.success("Copied to clipboard!")};return e.jsxs("div",{className:"p-6 bg-white rounded-xl shadow-lg",children:[e.jsx("h2",{className:"text-2xl font-bold text-blue-600 mb-4",children:"ðŸ§¾ Audit Trail"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"View all activity logs from the blockchain ledger. Every modification to medical records is transparently stored for accountability."}),x?e.jsx("p",{className:"text-gray-500 text-center",children:"Loading audit logs..."}):c.length===0?e.jsx("p",{className:"text-gray-500 text-center",children:"No audit records found."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse border border-gray-300 rounded-lg",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-blue-100",children:[e.jsx("th",{className:"p-3 text-left text-sm font-semibold border",children:"#"}),e.jsx("th",{className:"p-3 text-left text-sm font-semibold border",children:"Record ID"}),e.jsx("th",{className:"p-3 text-left text-sm font-semibold border",children:"Updated By"}),e.jsx("th",{className:"p-3 text-left text-sm font-semibold border",children:"Timestamp"}),e.jsx("th",{className:"p-3 text-left text-sm font-semibold border",children:"Transaction Hash"})]})}),e.jsx("tbody",{children:c.map((t,s)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"p-3 border",children:s+1}),e.jsx("td",{className:"p-3 border",children:t.recordId}),e.jsx("td",{className:"p-3 border text-gray-700",children:t.updatedBy}),e.jsx("td",{className:"p-3 border text-gray-600",children:t.timestamp}),e.jsxs("td",{className:"p-3 border text-blue-600 flex items-center gap-2",children:[e.jsx("span",{className:"truncate w-40",children:t.txHash}),e.jsx("button",{onClick:()=>m(t.txHash),className:"p-1 rounded-full hover:bg-blue-200",children:e.jsx(w,{size:16})})]})]},t.id))})]})}),d&&e.jsx("div",{className:"mt-8 border-t pt-4",children:e.jsxs("h3",{className:"text-gray-700 font-semibold",children:["Logged in as: ",e.jsx("span",{className:"text-blue-500",children:d.role})]})})]})};export{B as default};
